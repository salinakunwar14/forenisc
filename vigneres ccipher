#include <stdio.h>
#include <string.h>

void vigenere(char *msg, char *key, int encrypt) {
    for (int i = 0, j = 0; msg[i]; i++) {
        char k = key[j % strlen(key)];
        if (msg[i] >= 'a' && msg[i] <= 'z')
            msg[i] = (msg[i] - 'a' + (encrypt ? k - 'a' : 26 - (k - 'a'))) % 26 + 'a', j++;
        else if (msg[i] >= 'A' && msg[i] <= 'Z')
            msg[i] = (msg[i] - 'A' + (encrypt ? k - 'A' : 26 - (k - 'A'))) % 26 + 'A', j++;
    }
}

int main() {
    char msg[100], key[100];
    printf("Message: ");
    fgets(msg, sizeof(msg), stdin);
    msg[strcspn(msg, "\n")] = 0;

    printf("Key: ");
    scanf("%s", key);

    vigenere(msg, key, 1);
    printf("Encrypted: %s\n", msg);

    vigenere(msg, key, 0);
    printf("Decrypted: %s\n", msg);

    return 0;
}
